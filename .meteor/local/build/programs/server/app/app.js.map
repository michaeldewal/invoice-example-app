{"version":3,"sources":["meteor://ðŸ’»app/lib/functions.js","meteor://ðŸ’»app/lib/invoiceCollection.js","meteor://ðŸ’»app/lib/router.js","meteor://ðŸ’»app/server/invoices.js"],"names":[],"mappings":"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","file":"/app.js","sourcesContent":["String.prototype.firstToType = function(type = 'lower') {\r\n    switch(type) {\r\n        case 'lower':\r\n            return this.charAt(0).toLowerCase() + this.slice(1);\r\n        break;\r\n        case 'upper':\r\n            return this.charAt(0).toUpperCase() + this.slice(1);\r\n        break;\r\n    }\r\n};\r\n\r\nisEmpty = function(obj) {\r\n    return Object.getOwnPropertyNames(obj).length === 0;\r\n};","invoices = new Mongo.Collection(\"invoices\");\r\ninvoices.limit_results_by = 50;\r\ninvoices.limit_increase_by = 50;\r\ninvoices.byTimeRange = function(timeRange = \"today\", queryParams) {\r\n  let limit = invoices.limit_results_by;\r\n\r\n  if (queryParams !== undefined && queryParams.hasOwnProperty('limit')) {\r\n    limit = parseInt(queryParams.limit);\r\n    delete queryParams['limit'];\r\n  }\r\n\r\n  queryParams = (isEmpty(queryParams)) ? {sortCreatedAt: \"DESC\", sortTotal: \"ASC\"} : queryParams;\r\n\r\n  console.log(queryParams);\r\n  const sort = {};\r\n  const filter = {};\r\n  for (let k in queryParams) {\r\n    console.log('k', k);\r\n    if(k.indexOf('sort') > -1) {\r\n      sort[k.replace('sort', '').firstToType('lower')] = (queryParams[k] === 'DESC') ? -1 : 1;\r\n    } else if(k.indexOf('filter') > -1) {\r\n      if(!isNaN(parseInt(queryParams[k])) && queryParams[k] !== \"\") {\r\n        filter[k.replace('filter', '').firstToType('lower')] = (isNaN(parseInt(queryParams[k])))?queryParams[k]:parseInt(queryParams[k]);\r\n      }\r\n    }\r\n  }\r\n\r\n  const getTimeRange = function(timeRange) {\r\n    const today = new Date();\r\n    const timeRanges = {\r\n      today(){\r\n        today.setSeconds(0);\r\n        today.setMinutes(0);\r\n        today.setHours(0);\r\n        return today;\r\n      },\r\n      week(){\r\n        return new Date(today.getFullYear(), today.getMonth(), today.getDate() - 7);\r\n      },\r\n      month(){\r\n        return new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());\r\n      },\r\n      all(){\r\n        return false;\r\n      }\r\n    };\r\n\r\n    if(timeRanges[timeRange]) {\r\n      return timeRanges[timeRange]();\r\n    } else {\r\n      return timeRanges['today']();\r\n    }\r\n  };\r\n\r\n  const selectedDate = getTimeRange(timeRange);\r\n\r\n\r\n  if(selectedDate !== false) filter.createdAt = { '$gte': selectedDate };\r\n  console.log(filter);\r\n  return invoices.find(filter, {sort: sort});\r\n};\r\n\r\n/*\r\nTODO implement this\r\n\r\ninvoices.createFilter = function(params){\r\n  let fn;\r\n  const typeCaster = function(type, variable) {\r\n    const types = {\r\n      text(v) {\r\n        return v;\r\n      },\r\n      number(v) {\r\n        return parseInt(v);\r\n      },\r\n      date(v) {\r\n        return new Date(v);\r\n      }\r\n    };\r\n    if(types[type]) {\r\n      return types[type](variable);\r\n    } else {\r\n      return types['text'](variable);\r\n    }\r\n  };\r\n  let filter = {};\r\n  params.forEach(function(param){\r\n    filter[param.name] = typeCaster(params.type, params,value);\r\n  });\r\n\r\n  console.log(filter);\r\n};\r\n  */","FlowRouter.route(\"/:type\", {\r\n    name: \"invoices\",\r\n    subscriptions: function(params, queryParams) {\r\n            this.register(\"invoiceCollection\", Meteor.subscribe(\"invoiceCollection\", params.type, queryParams));\r\n    },\r\n    action: function(params, queryParams) {\r\n        BlazeLayout.render(\"invoicesTemplate\");\r\n    }\r\n});\r\nFlowRouter.route(\"/\", {\r\n    action: function(params, queryParams) {\r\n        Router.go({type: 'all'});\r\n    }\r\n});\r\n\r\nRouter = {\r\n    route: '',\r\n    reactvar: new ReactiveVar(0),\r\n    setRoute: function(routeName) {\r\n        this.route = routeName;\r\n    },\r\n\r\n    resetQuery: function() {\r\n        FlowRouter.go(FlowRouter.path(this.route, FlowRouter.current().params));\r\n    },\r\n\r\n    go: function(routeParams, queryParamName = '') {\r\n\r\n        const currentQueryParams = FlowRouter.current().queryParams;\r\n        \r\n        if(routeParams === '')\r\n            routeParams = FlowRouter.current().params;\r\n\r\n        if(currentQueryParams.hasOwnProperty(queryParamName)) {\r\n            currentQueryParams[queryParamName] = (currentQueryParams[queryParamName] == 'ASC')?'DESC':'ASC'\r\n        } else if(queryParamName !== '')\r\n        {\r\n            currentQueryParams[queryParamName] = 'ASC';\r\n        }\r\n\r\n        this.reactvar.set((this.reactvar.get() === 1?0:1));\r\n        if(!isEmpty(currentQueryParams)) {\r\n            FlowRouter.go(FlowRouter.path(this.route, routeParams, currentQueryParams));\r\n        } else {\r\n            FlowRouter.go(FlowRouter.path(this.route, routeParams));\r\n        }\r\n    },\r\n\r\n    getParams: function() {\r\n        return FlowRouter.current().params;\r\n    },\r\n\r\n    getQueryParams: function() {\r\n        return (FlowRouter.current().queryParams === undefined)?{}:FlowRouter.current().queryParams;\r\n    },\r\n    addQueryParam: function(name, value) {\r\n\r\n        const params = FlowRouter.current().queryParams;\r\n        params[name] = value;\r\n\r\n        FlowRouter.setQueryParams(params);\r\n    }\r\n};","Meteor.publish(\"invoiceCollection\", function(filter, params){\r\n    return invoices.byTimeRange(filter, params);\r\n});\r\n\r\nMeteor.methods({\r\n    generateInvoices: function() {\r\n    const total = 100;\r\n    for(let i=0;i<total;i++) {\r\n\r\n        const curDate = new Date().getTime();\r\n        let lastMonthDate = new Date();\r\n        lastMonthDate.setMonth(lastMonthDate.getMonth()-1);\r\n        lastMonthDate = lastMonthDate.getTime();\r\n        let date = new Date(lastMonthDate + Math.random() * (curDate - lastMonthDate));\r\n        date.setHours(0);\r\n        date.setMinutes(0);\r\n        date.setSeconds(0);\r\n        date.setMilliseconds(0);\r\n\r\n        invoices.insert({\r\n            invoiceNr: Math.floor(Math.random() * (1000000 + 1)),\r\n            total: Math.floor(Math.random() * (100000 + 1)),\r\n            createdAt: date\r\n        });\r\n    }\r\n}});"]}