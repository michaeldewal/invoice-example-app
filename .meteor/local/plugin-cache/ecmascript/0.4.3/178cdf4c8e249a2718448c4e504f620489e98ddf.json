{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/lib/invoiceCollection.js","filenameRelative":"/lib/invoiceCollection.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/lib/invoiceCollection.js.map","sourceFileName":"/lib/invoiceCollection.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"invoiceCollection"},"ignored":false,"code":"invoices = new Mongo.Collection(\"invoices\");\ninvoices.limit_results_by = 50;\ninvoices.limit_increase_by = 50;\ninvoices.byTimeRange = function () {\n  var timeRange = arguments.length <= 0 || arguments[0] === undefined ? \"today\" : arguments[0];\n  var queryParams = arguments[1];\n  var filter = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\n  var limit = invoices.limit_results_by;\n\n  if (queryParams !== undefined && queryParams.hasOwnProperty('limit')) {\n    limit = parseInt(queryParams.limit);\n    delete queryParams['limit'];\n  }\n\n  queryParams = isEmpty(queryParams) ? { sortCreatedAt: \"DESC\", sortTotal: \"ASC\" } : queryParams;\n\n  var sort = {};\n  for (var k in meteorBabelHelpers.sanitizeForInObject(queryParams)) {\n    sort[k.replace('sort', '').firstToType('lower')] = queryParams[k] === 'DESC' ? -1 : 1;\n  }\n\n  var selectedDate = void 0;\n  var today = new Date();\n  switch (timeRange) {\n    case 'week':\n      selectedDate = new Date(today.getFullYear(), today.getMonth(), today.getDate() - 7);\n      break;\n    case 'month':\n      selectedDate = new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());\n      break;\n    case 'all':\n      selectedDate = false;\n      break;\n    default:\n    case 'today':\n      selectedDate = today;\n      selectedDate.setSeconds(0);\n      selectedDate.setHours(0);\n      selectedDate.setMinutes(0);\n      break;\n  }\n\n  if (filter !== false) {\n    filter = invoices.createFilter(filter);\n  }\n\n  var query = selectedDate !== false ? { createdAt: { '$gte': selectedDate } } : {};\n  return invoices.find(query, { sort: sort });\n};\n\ninvoices.createFilter = function (params) {\n  var fn = void 0;\n  var typeCaster = function typeCaster(type, variable) {\n    var types = {\n      text: function () {\n        function text(v) {\n          return v;\n        }\n\n        return text;\n      }(),\n      number: function () {\n        function number(v) {\n          return parseInt(v);\n        }\n\n        return number;\n      }(),\n      date: function () {\n        function date(v) {\n          return new Date(v);\n        }\n\n        return date;\n      }()\n    };\n    if (types[type]) {\n      fn = types[type];\n    } else {\n      fn = types['text'];\n    }\n    return fn();\n  };\n  var filter = {};\n  params.forEach(function (param) {\n\n    filter[param.name] = typeCaster(params.type, params, value);\n  });\n\n  console.log(filter);\n};","ast":null,"map":{"version":3,"sources":["/lib/invoiceCollection.js"],"names":[],"mappings":"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","file":"/lib/invoiceCollection.js.map","sourcesContent":["invoices = new Mongo.Collection(\"invoices\");\r\ninvoices.limit_results_by = 50;\r\ninvoices.limit_increase_by = 50;\r\ninvoices.byTimeRange = function(timeRange = \"today\", queryParams, filter = false) {\r\n  let limit = invoices.limit_results_by;\r\n\r\n  if (queryParams !== undefined && queryParams.hasOwnProperty('limit')) {\r\n    limit = parseInt(queryParams.limit);\r\n    delete queryParams['limit'];\r\n  }\r\n\r\n  queryParams = (isEmpty(queryParams)) ? {sortCreatedAt: \"DESC\", sortTotal: \"ASC\"} : queryParams;\r\n\r\n  const sort = {};\r\n  for (let k in queryParams) {\r\n    sort[k.replace('sort', '').firstToType('lower')] = (queryParams[k] === 'DESC') ? -1 : 1;\r\n  }\r\n\r\n  let selectedDate;\r\n  const today = new Date();\r\n  switch (timeRange) {\r\n    case 'week':\r\n      selectedDate = new Date(today.getFullYear(), today.getMonth(), today.getDate() - 7);\r\n      break;\r\n    case 'month':\r\n      selectedDate = new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());\r\n      break;\r\n    case 'all':\r\n      selectedDate = false;\r\n      break;\r\n    default:\r\n    case 'today':\r\n      selectedDate = today;\r\n      selectedDate.setSeconds(0);\r\n      selectedDate.setHours(0);\r\n      selectedDate.setMinutes(0);\r\n      break;\r\n  }\r\n\r\n\r\n  if(filter !== false) {\r\n      filter = invoices.createFilter(filter);\r\n  }\r\n\r\n  const query = (selectedDate !== false)?{ createdAt: { '$gte': selectedDate }}:{};\r\n  return invoices.find(query, {sort: sort});\r\n};\r\n\r\ninvoices.createFilter = function(params){\r\n  let fn;\r\n  const typeCaster = function(type, variable) {\r\n    const types = {\r\n      text(v) {\r\n        return v;\r\n      },\r\n      number(v) {\r\n        return parseInt(v);\r\n      },\r\n      date(v) {\r\n        return new Date(v);\r\n      }\r\n    };\r\n    if(types[type]) {\r\n      fn = types[type];\r\n    } else {\r\n      fn = types['text'];\r\n    }\r\n    return fn();\r\n  };\r\n  let filter = {};\r\n  params.forEach(function(param){\r\n\r\n    filter[param.name] = typeCaster(params.type, params,value);\r\n  });\r\n\r\n  console.log(filter);\r\n};"]},"hash":"178cdf4c8e249a2718448c4e504f620489e98ddf"}
