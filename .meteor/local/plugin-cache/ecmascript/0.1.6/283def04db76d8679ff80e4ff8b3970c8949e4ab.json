{"metadata":{"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}},"usedHelpers":["inherits","class-call-check"]},"ignored":false,"code":"var DEFAULT_API = ['state', 'props', 'helpers', 'events', 'onCreated', 'onRendered', 'onDestroyed'];\n\n// Helpers\nvar withTemplateInstanceContext = function (handler) {\n  return function () {\n    return handler.apply(Template.instance(), arguments);\n  };\n};\n\nvar bindToTemplateInstance = function (handlers) {\n  for (var _iterator = Object.keys(handlers), _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n    var _ref;\n\n    if (_isArray) {\n      if (_i >= _iterator.length) break;\n      _ref = _iterator[_i++];\n    } else {\n      _i = _iterator.next();\n      if (_i.done) break;\n      _ref = _i.value;\n    }\n\n    var key = _ref;\n\n    handlers[key] = withTemplateInstanceContext(handlers[key]);\n  }\n  return handlers;\n};\n\nvar generateReactiveAccessor = function (defaultValue) {\n  var value = new ReactiveVar(defaultValue);\n  return function (newValue) {\n    if (newValue !== undefined) {\n      value.set(newValue);\n    } else {\n      return value.get();\n    }\n  };\n};\n\n// Errors\n\nvar TemplateNotFoundError = (function (_ExtendableError) {\n  babelHelpers.inherits(TemplateNotFoundError, _ExtendableError);\n\n  function TemplateNotFoundError(templateName) {\n    babelHelpers.classCallCheck(this, TemplateNotFoundError);\n\n    _ExtendableError.call(this, 'No template <' + templateName + '> found.');\n  }\n\n  return TemplateNotFoundError;\n})(ExtendableError);\n\nvar PropertyValidatorRequired = (function (_ExtendableError2) {\n  babelHelpers.inherits(PropertyValidatorRequired, _ExtendableError2);\n\n  function PropertyValidatorRequired() {\n    babelHelpers.classCallCheck(this, PropertyValidatorRequired);\n\n    _ExtendableError2.call(this, '<data> must be a validator with #clean and #validate methods (see: SimpleSchema)');\n  }\n\n  // We have to make it a global to support Meteor 1.2.x\n  return PropertyValidatorRequired;\n})(ExtendableError);\n\nTemplateController = function (templateName, config) {\n  // Template reference\n  var template = Template[templateName];\n  if (!template) {\n    throw new TemplateNotFoundError(templateName);\n  }\n  var state = config.state;\n  var props = config.props;\n  var helpers = config.helpers;\n  var events = config.events;\n  var onCreated = config.onCreated;\n  var onRendered = config.onRendered;\n  var onDestroyed = config.onDestroyed;\n\n  // Remove all standard api props fromt he config so we can have add the\n  // rest to the template instance!\n  for (var _iterator2 = DEFAULT_API, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {\n    if (_isArray2) {\n      if (_i2 >= _iterator2.length) break;\n      apiProp = _iterator2[_i2++];\n    } else {\n      _i2 = _iterator2.next();\n      if (_i2.done) break;\n      apiProp = _i2.value;\n    }\n\n    delete config[apiProp];\n  }\n\n  // State & private instance methods\n  template.onCreated(function () {\n    var _this = this;\n\n    if (state) {\n      this.state = {};\n      // Setup the state as reactive vars\n      for (var _iterator3 = Object.keys(state), _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {\n        var _ref2;\n\n        if (_isArray3) {\n          if (_i3 >= _iterator3.length) break;\n          _ref2 = _iterator3[_i3++];\n        } else {\n          _i3 = _iterator3.next();\n          if (_i3.done) break;\n          _ref2 = _i3.value;\n        }\n\n        var key = _ref2;\n\n        this.state[key] = generateReactiveAccessor(state[key]);\n      }\n    }\n    // Private\n    if (config['private']) {\n      for (var _iterator4 = Object.keys(config['private']), _isArray4 = Array.isArray(_iterator4), _i4 = 0, _iterator4 = _isArray4 ? _iterator4 : _iterator4[Symbol.iterator]();;) {\n        var _ref3;\n\n        if (_isArray4) {\n          if (_i4 >= _iterator4.length) break;\n          _ref3 = _iterator4[_i4++];\n        } else {\n          _i4 = _iterator4.next();\n          if (_i4.done) break;\n          _ref3 = _i4.value;\n        }\n\n        var key = _ref3;\n\n        this[key] = config['private'][key];\n      }\n    }\n    // Add sugar method for triggering custom jQuery events on the root node\n    this.triggerEvent = function (eventName, data) {\n      _this.$(_this.firstNode).trigger(eventName, data);\n    };\n  });\n\n  // Default values for props\n  if (props) {\n    template.onCreated(function () {\n      var _this2 = this;\n\n      this.props = {};\n      this.autorun(function () {\n        if (!props.validate) throw new PropertyValidatorRequired();\n        var currentData = Template.currentData() || {};\n        props.clean(currentData);\n        props.validate(currentData);\n        for (var _iterator5 = Object.keys(currentData), _isArray5 = Array.isArray(_iterator5), _i5 = 0, _iterator5 = _isArray5 ? _iterator5 : _iterator5[Symbol.iterator]();;) {\n          var _ref4;\n\n          if (_isArray5) {\n            if (_i5 >= _iterator5.length) break;\n            _ref4 = _iterator5[_i5++];\n          } else {\n            _i5 = _iterator5.next();\n            if (_i5.done) break;\n            _ref4 = _i5.value;\n          }\n\n          var key = _ref4;\n\n          var value = currentData[key];\n          if (!_this2.props[key]) {\n            _this2.props[key] = generateReactiveAccessor(value);\n          } else {\n            _this2.props[key](value);\n          }\n        }\n      });\n    });\n  }\n  // Helpers\n  if (!helpers) helpers = {};\n  helpers.state = function () {\n    return this.state;\n  };\n  helpers.props = function () {\n    return this.props;\n  };\n  template.helpers(bindToTemplateInstance(helpers));\n\n  // Events\n  if (events) {\n    template.events(bindToTemplateInstance(events));\n  }\n\n  // Lifecycle\n  if (onCreated) template.onCreated(onCreated);\n  if (onRendered) template.onRendered(onRendered);\n  if (onDestroyed) template.onDestroyed(onDestroyed);\n};","ast":null,"map":{"version":3,"sources":["/source/template-controller.js"],"names":[],"mappings":"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","file":"/source/template-controller.js.map","sourcesContent":["const DEFAULT_API = [\n  'state', 'props', 'helpers', 'events', 'onCreated', 'onRendered', 'onDestroyed'\n];\n\n// Helpers\nconst withTemplateInstanceContext = function(handler) {\n  return function() {\n    return handler.apply(Template.instance(), arguments);\n  };\n};\n\nconst bindToTemplateInstance = function(handlers) {\n  for (let key of Object.keys(handlers)) {\n    handlers[key] = withTemplateInstanceContext(handlers[key]);\n  }\n  return handlers;\n};\n\nconst generateReactiveAccessor = function(defaultValue) {\n  let value = new ReactiveVar(defaultValue);\n  return function(newValue) {\n    if (newValue !== undefined) {\n      value.set(newValue);\n    } else {\n      return value.get();\n    }\n  };\n};\n\n// Errors\nclass TemplateNotFoundError extends ExtendableError {\n  constructor(templateName) {\n    super(`No template <${templateName}> found.`);\n  }\n}\n\nclass PropertyValidatorRequired extends ExtendableError {\n  constructor() {\n    super('<data> must be a validator with #clean and #validate methods (see: SimpleSchema)');\n  }\n}\n\n// We have to make it a global to support Meteor 1.2.x\nTemplateController = function(templateName, config) {\n  // Template reference\n  let template = Template[templateName];\n  if (!template) {\n    throw new TemplateNotFoundError(templateName);\n  }\n  let { state, props, helpers, events, onCreated, onRendered, onDestroyed } = config;\n\n  // Remove all standard api props fromt he config so we can have add the\n  // rest to the template instance!\n  for (apiProp of DEFAULT_API) {\n    delete config[apiProp];\n  }\n\n  // State & private instance methods\n  template.onCreated(function() {\n    if (state) {\n      this.state = {};\n      // Setup the state as reactive vars\n      for (let key of Object.keys(state)) {\n        this.state[key] = generateReactiveAccessor(state[key]);\n      }\n    }\n    // Private\n    if (config.private) {\n      for (let key of Object.keys(config.private)) {\n        this[key] = config.private[key];\n      }\n    }\n    // Add sugar method for triggering custom jQuery events on the root node\n    this.triggerEvent = (eventName, data) => {\n      this.$(this.firstNode).trigger(eventName, data);\n    };\n  });\n\n  // Default values for props\n  if (props) {\n    template.onCreated(function() {\n      this.props = {};\n      this.autorun(() => {\n        if (!props.validate) throw new PropertyValidatorRequired();\n        let currentData = Template.currentData() || {};\n        props.clean(currentData);\n        props.validate(currentData);\n        for (let key of Object.keys(currentData)) {\n          let value = currentData[key];\n          if (!this.props[key]) {\n            this.props[key] = generateReactiveAccessor(value);\n          } else {\n            this.props[key](value);\n          }\n        }\n      });\n    });\n  }\n  // Helpers\n  if (!helpers) helpers = {};\n  helpers.state = function() { return this.state; };\n  helpers.props = function() { return this.props; };\n  template.helpers(bindToTemplateInstance(helpers));\n\n  // Events\n  if (events) {\n    template.events(bindToTemplateInstance(events));\n  }\n\n  // Lifecycle\n  if (onCreated) template.onCreated(onCreated);\n  if (onRendered) template.onRendered(onRendered);\n  if (onDestroyed) template.onDestroyed(onDestroyed);\n\n};\n"]},"hash":"283def04db76d8679ff80e4ff8b3970c8949e4ab"}
